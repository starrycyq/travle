# 项目后续开发路线图（四阶段）

## 阶段一：云端部署与内网穿透
**目标**：让后端服务长期运行在阿里云服务器，可被公网访问，接收 APP 模拟请求。
- 服务器环境：Ubuntu 22.04，IP `121.43.58.117`，开放端口 22/80/5000。
- 步骤：
  1. 上传项目代码至服务器（git clone 或 scp）。
  2. 创建 Python 虚拟环境并安装依赖。
  3. 配置 `.env`（数据库路径、DeepSeek API Key、ChromaDB 路径等）。
  4. 使用 Systemd 创建服务 `travle_backend.service` 保活 Flask。
  5. （可选）配置 Nginx 反向代理与域名。
  6. 启动服务并验证公网可访问性（curl / 浏览器）。

## 阶段二：业务流程真实测试
**目标**：验证从登录→爬取→清洗→向量化→存储的完整链路，按用户隔离数据。
- 模拟 APP 请求：
  1. 调用 `/api/auth/xiaohongshu/send_code` 发送验证码（模拟手机号）。
  2. 调用 `/api/auth/xiaohongshu` 完成登录，获取 cookies。
  3. 调用爬取接口触发 `_scrape_xiaohongshu`（带登录态）。
  4. 数据清洗 → 调用 DeepSeek API → 存入 ChromaDB（按 user_id 分区）。
- 验证点：
  - 登录态在爬虫中有效。
  - 数据正确清洗并向量化。
  - 每个用户数据独立存储与检索。

## 阶段三：AI 实时对话接口开发
**目标**：为每个用户提供基于其历史数据的实时 AI 对话能力。
- 新增接口 `/api/chat`：
  1. 接收用户消息与 user_id。
  2. 检索该用户在 ChromaDB 的相关笔记向量。
  3. 构造上下文 + 用户消息，调用 DeepSeek ChatCompletion。
  4. 返回 AI 回复并记录对话历史（可选）。
- 前端 APP 增加对话窗口页面（预留）。

## 阶段四：APP 端集成与端到端测试
**目标**：APP 调用云端 API，实现完整功能闭环。
- APP 功能页面（已有 6 个）：
  1. 登录/注册
  2. 小红书授权（现改为验证码登录）
  3. 笔记爬取与展示
  4. 数据清洗结果浏览
  5. 向量检索演示
  6. 设置
- 新增第 7 页：AI 实时对话窗口。
- 联调测试：APP → 云端 API → 后端流程 → 返回结果。

---
**备注**：每阶段完成后更新本文件，确保开发记忆持续可用。